<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>MBTA Alerts</title>
    <style>
      .digest-group-section:nth-child(even) {
        background-color: #f4f4f6 !important;
      }
      .digest-group-section > table:not(:last-child) tr > td:last-child {
        padding-bottom: 18px;
        border-bottom: solid 2px #dddddd;
      }
    </style>
  </head>
  <body leftmargin="0" marginwidth="0" topmargin="0" marginheight="0" offset="0">
    <%= AlertProcessor.MailHelper.header %>

    <h1 class="digest-title">
      T-Alerts: Weekly Digest
    </h1>

    <div class="digest-group">
      <%= for group <- digest_date_groups do %>
        <div class="digest-group-section">
          <div class="digest-group-section-title">
            <%= group.title %>:
          </div>
          <%= for alert <- group.alerts do %>
            <table class="digest-group-alert">
              <tr>
                <td class="alert-logo">
                  <img src="<%= AlertProcessor.MailHelper.logo_for_alert(alert) %>"
                   alt="<%= AlertProcessor.MailHelper.alt_text_for_alert(alert) %>">
                </td>
                <td class="alert-details">
                  <p class="alert-service-effect">
                    <%= alert.service_effect %>:
                  </p>
                  <p class="alert-header">
                    <%= alert.header %>
                  </p>
                </td>
              </tr>
            </table>
          <% end %>
        </div>
      <% end %>
    </div>

    <div class="line" />

    <center>
      <div class="digest-footer">
        <div class="digest-footer-description">
          The digest of upcoming events has been personalized to you based on your subscription, for full list:
        </div>

        <div class="digest-footer-link-wrapper">
          <a class="digest-footer-link" href="https://t.mbta.com/">
            <div class="digest-footer-button">
              View All Alerts
            </div>
          </a>
        </div>
      </div>

      <%= AlertProcessor.MailHelper.footer %>
    </center>
	</body>
</html>
